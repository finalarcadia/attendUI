<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="student-class">
	<template>
	<style include="shared-styles">
	:host {
		--my-color: var(--accent-color);
		--present-color: var(--paper-green-a700);
		--late-color: var(--paper-amber-500);
		--absent-color: var(--paper-red-700);
		--attempt-color: var(--paper-grey-500);
		--late-percent: 25;
		--present-percent: 25;
		--attempt-percent: 25;
		--absent-percent: 25;
	}

	paper-card {
		width: 100%;
		--paper-card-content: {
			font-size: 26px;
			font-weight: 500;
			color: white;
			background: var(--my-color);
		}
	}

	paper-icon-button {
		vertical-align: bottom;
	}

	paper-input {
		--paper-input-container-focus-color: var(--my-color);
		display: inline-block;
		width: 90px;
	}

	paper-button {
		display: inline-block;
		color: var(--my-color);
	}

	paper-fab {
		float: right;
		display: inline-block;
		--paper-fab-background: var(--my-color);
	}

	iron-collapse {
		width: 100%;
	}

	paper-dialog {

	}

	#graphContainer {
		width: 100%;
		height: 26px;
		text-align: center;
	}

	#lateBar {
		width: var(--late-percent)%;
		background-color: var(--late-color);
		display: inline-block;
		color: white;
		height: 100%;
		padding-top: 7px;
	}

	#presentBar {
		width: var(--present-percent)%;
		background-color: var(--present-color);
		display: inline-block;
		color: white;
		height: 100%;
		padding-top: 7px;
	}

	#attemptBar {
		width: var(--attempt-percent)%;
		background-color: var(--attempt-color);
		display: inline-block;
		color: white;
		height: 100%;
		padding-top: 7px;
	}

	#absentBar {
		width: var(--absent-percent)%;
		background-color: var(--absent-color);
		display: inline-block;
		color: white;
		height: 100%;
		padding-top: 7px;
	}

	#score {
		color: var(--my-color);
		@apply(--paper-font-display1);
	}

	</style>

	<paper-card>
		<!-- header -->
		<div class="card-content">
			<iron-icon icon="maps:local-library"></iron-icon>
			{{className}}
			<iron-icon icon="device:access-time" style="float:right;"></iron-icon>
			<iron-icon icon="device:gps-fixed" hidden$="{{!locationReq}}" style="float:right;"></iron-icon>
			<iron-icon icon="editor:border-color" hidden$="{{!codeReq}}" style="float:right;"></iron-icon>
		</div>

		<!-- middle -->
		<div class="card-actions">

			<paper-input label="Enter code" hidden$="{{!codeReq}}" no-label-float></paper-input>
			<paper-button onclick="_toggleDialog(recordDialog)"><iron-icon icon="image:edit"></iron-icon>Record</paper-button>

			<paper-icon-button icon="hardware:keyboard-arrow-up" title="more info" onclick="_toggle()"
			style="float: right;"></paper-icon-button>
			<script>
			function _toggle() {
				var moreInfo = event.currentTarget.parentElement.querySelector('iron-collapse');
				var iconButton = Polymer.dom(event).localTarget;
				iconButton.icon = moreInfo.opened ? 'hardware:keyboard-arrow-up'
				: 'hardware:keyboard-arrow-down';
				moreInfo.toggle();
			}
			</script>

			<!-- Dropdown Content -->

			<iron-collapse id="dropdown">
				<div id="graphContainer">
					<div id="lateBar">{{late}}%</div><div id="presentBar">{{present}}%</div><div id="attemptBar">{{attempt}}%</div><div id="absentBar">{{absent}}%</div>
				</div>
				<br>
				<span id="score">Score: {{score}}%</span>
				<paper-fab mini icon="close" onclick="_toggleDialog('#dropClassDialog')"></paper-fab>
			</iron-collapse>
		</div>
	</paper-card>

</template>

<script>

Polymer({
	is: 'student-class',

	properties: {

		elementColor: {
			type: String,
			value: 'var(--accent-color)',
		},

		className: {
			type: String,
			value: 'noClassNameGiven',
		},

		locationReq: {
			type: Boolean,
			value: false
		},

		codeReq: {
			type: Boolean,
			value: false,
		},

		late: {
			type: String,
			value: '25',
		},

		present: {
			type: String,
			value: '25',
		},

		attempt: {
			type: String,
			value: '25',
		},

		absent: {
			type: String,
			value: '25',
		},

		score: {
			type: String,
			value: '75',
		}

	},

	ready: function() {
		this.customStyle['--my-color'] = this.elementColor;
		this.customStyle['--late-percent'] = this.late;
		this.customStyle['--present-percent'] = this.present;
		this.customStyle['--attempt-percent'] = this.attempt;
		this.customStyle['--absent-percent'] = this.absent;
		this.updateStyles();
	}
});

var recordDialog = '#presentDialog';

function _toggleDialog(dialogId) {
	document.querySelector(dialogId).toggle();
}
</script>
</dom-module>
